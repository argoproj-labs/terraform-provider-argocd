---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "argocd_cluster Resource - terraform-provider-argocd"
subcategory: ""
description: |-
  Manages clusters https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#clusters within ArgoCD.
---

# argocd_cluster (Resource)

Manages [clusters](https://argo-cd.readthedocs.io/en/stable/operator-manual/declarative-setup/#clusters) within ArgoCD.

## Example Usage

```terraform
## Bearer token Authentication
resource "argocd_cluster" "kubernetes" {
  server = "https://1.2.3.4:12345"

  config {
    bearer_token = "eyJhbGciOiJSUzI..."

    tls_client_config {
      ca_data = file("path/to/ca.pem")
      // ca_data = "-----BEGIN CERTIFICATE-----\nfoo\nbar\n-----END CERTIFICATE-----"
      // ca_data = base64decode("LS0tLS1CRUdJTiBDRVJUSUZ...")
      // insecure = true
    }
  }
}

## GCP GKE cluster
data "google_container_cluster" "cluster" {
  name     = "cluster"
  location = "europe-west1"
}

resource "kubernetes_service_account" "argocd_manager" {
  metadata {
    name      = "argocd-manager"
    namespace = "kube-system"
  }
}

resource "kubernetes_cluster_role" "argocd_manager" {
  metadata {
    name = "argocd-manager-role"
  }

  rule {
    api_groups = ["*"]
    resources  = ["*"]
    verbs      = ["*"]
  }

  rule {
    non_resource_urls = ["*"]
    verbs             = ["*"]
  }
}

resource "kubernetes_cluster_role_binding" "argocd_manager" {
  metadata {
    name = "argocd-manager-role-binding"
  }

  role_ref {
    api_group = "rbac.authorization.k8s.io"
    kind      = "ClusterRole"
    name      = kubernetes_cluster_role.argocd_manager.metadata.0.name
  }

  subject {
    kind      = "ServiceAccount"
    name      = kubernetes_service_account.argocd_manager.metadata.0.name
    namespace = kubernetes_service_account.argocd_manager.metadata.0.namespace
  }
}

data "kubernetes_secret" "argocd_manager" {
  metadata {
    name      = kubernetes_service_account.argocd_manager.default_secret_name
    namespace = kubernetes_service_account.argocd_manager.metadata.0.namespace
  }
}

resource "argocd_cluster" "gke" {
  server = format("https://%s", data.google_container_cluster.cluster.endpoint)
  name   = "gke"

  config {
    bearer_token = data.kubernetes_secret.argocd_manager.data["token"]
    tls_client_config {
      ca_data = base64decode(data.google_container_cluster.cluster.master_auth.0.cluster_ca_certificate)
    }
  }
}

## AWS EKS cluster
data "aws_eks_cluster" "cluster" {
  name = "cluster"
}

resource "argocd_cluster" "eks" {
  server     = format("https://%s", data.aws_eks_cluster.cluster.endpoint)
  name       = "eks"
  namespaces = ["default", "optional"]

  config {
    aws_auth_config {
      cluster_name = "myekscluster"
      role_arn     = "arn:aws:iam::<123456789012>:role/<role-name>"
    }
    tls_client_config {
      ca_data = base64decode(data.aws_eks_cluster.cluster.certificate_authority[0].data)
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `config` (Block List, Min: 1, Max: 1) Cluster information for connecting to a cluster. (see [below for nested schema](#nestedblock--config))

### Optional

- `metadata` (Block List, Max: 2) Standard cluster secret's metadata. More info: https://github.com/kubernetes/community/blob/master/contributors/devel/sig-architecture/api-conventions.md#metadata (see [below for nested schema](#nestedblock--metadata))
- `name` (String) Name of the cluster. If omitted, will use the server address.
- `namespaces` (List of String) List of namespaces which are accessible in that cluster. Cluster level resources would be ignored if namespace list is not empty.
- `project` (String) Reference between project and cluster that allow you automatically to be added as item inside Destinations project entity. More info: https://argo-cd.readthedocs.io/en/stable/user-guide/projects/#project-scoped-repositories-and-clusters.
- `server` (String) Server is the API server URL of the Kubernetes cluster.
- `shard` (String) Optional shard number. Calculated on the fly by the application controller if not specified.

### Read-Only

- `id` (String) The ID of this resource.
- `info` (List of Object) Information about cluster cache and state. (see [below for nested schema](#nestedatt--info))

<a id="nestedblock--config"></a>
### Nested Schema for `config`

Optional:

- `aws_auth_config` (Block List) (see [below for nested schema](#nestedblock--config--aws_auth_config))
- `bearer_token` (String, Sensitive) Server requires Bearer authentication. The client will not attempt to use refresh tokens for an OAuth2 flow.
- `exec_provider_config` (Block List, Max: 1) Configuration for an exec provider used to call an external command to perform cluster authentication See: https://godoc.org/k8s.io/client-go/tools/clientcmd/api#ExecConfig. (see [below for nested schema](#nestedblock--config--exec_provider_config))
- `password` (String, Sensitive) Password for servers that require Basic authentication.
- `tls_client_config` (Block List, Max: 1) Settings to enable transport layer security when connecting to the cluster. (see [below for nested schema](#nestedblock--config--tls_client_config))
- `username` (String) Username for servers that require Basic authentication.

<a id="nestedblock--config--aws_auth_config"></a>
### Nested Schema for `config.aws_auth_config`

Optional:

- `cluster_name` (String) AWS cluster name.
- `role_arn` (String) IAM role ARN. If set then AWS IAM Authenticator assume a role to perform cluster operations instead of the default AWS credential provider chain.


<a id="nestedblock--config--exec_provider_config"></a>
### Nested Schema for `config.exec_provider_config`

Optional:

- `api_version` (String) Preferred input version of the ExecInfo
- `args` (List of String, Sensitive) Arguments to pass to the command when executing it
- `command` (String) Command to execute
- `env` (Map of String, Sensitive) Env defines additional environment variables to expose to the process. Passed as a map of strings
- `install_hint` (String) This text is shown to the user when the executable doesn't seem to be present


<a id="nestedblock--config--tls_client_config"></a>
### Nested Schema for `config.tls_client_config`

Optional:

- `ca_data` (String) PEM-encoded bytes (typically read from a root certificates bundle).
- `cert_data` (String) PEM-encoded bytes (typically read from a client certificate file).
- `insecure` (Boolean) Whether server should be accessed without verifying the TLS certificate.
- `key_data` (String, Sensitive) PEM-encoded bytes (typically read from a client certificate key file).
- `server_name` (String) Name to pass to the server for SNI and used in the client to check server certificates against. If empty, the hostname used to contact the server is used.



<a id="nestedblock--metadata"></a>
### Nested Schema for `metadata`

Optional:

- `annotations` (Map of String) An unstructured key value map stored with the cluster secret that may be used to store arbitrary metadata. More info: http://kubernetes.io/docs/user-guide/annotations
- `labels` (Map of String) Map of string keys and values that can be used to organize and categorize (scope and select) the cluster secret. May match selectors of replication controllers and services. More info: http://kubernetes.io/docs/user-guide/labels


<a id="nestedatt--info"></a>
### Nested Schema for `info`

Read-Only:

- `applications_count` (String)
- `connection_state` (List of Object) (see [below for nested schema](#nestedobjatt--info--connection_state))
- `server_version` (String)

<a id="nestedobjatt--info--connection_state"></a>
### Nested Schema for `info.connection_state`

Read-Only:

- `message` (String)
- `status` (String)

## Import

Import is supported using the following syntax:

```shell
# Cluster credentials can be imported using the server URL.

# Example:
terraform import argocd_cluster.mycluster https://mycluster.io:443
```
